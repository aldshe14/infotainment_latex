\chapter{Umsetzung - Irena Bala}
\section{Allgemeine Beschreibungen}
Bei dieser Diplomarbeit wurde darauf abgezielt, ein intelligentes System zu entwickeln, dass die täglichen Aufgaben des Menschen erleichtert und so viel wie möglich automatisch gesteuert wird. Um dieses Ziel zu erreichen wurden bestimmte Komponenten im System implementiert. Diese wurden mit Absicht so ausgewählt, um die zukünftige Erweiterung und Umsetzung des Projekts auf vielen Anwendungsgebiete zu erlauben.  Ein weiterer Zweck besteht auch darin, das System zu vervollständigen und sein Entwicklungsgemeinde zu vergrößern. \\
Diese Komponente wurden in unterschiedlichen Bereichen unterteilt. Der erste Bereich ist die Datenbank. Die Datenbank ist der wesentliche Bestandteil des Systems, weil es die Basis für die Speicherung der benötigten Daten bildet. In die Datenbank wurden alle von den verwendeten APIs empfangene Daten gespeichert. Außerdem wurden dort auch die Schuldaten hinterlegt. Diese Daten sind ein separater Teil des Projekts, die in den folgenden Kapiteln genauer erklärt werden. \\
Die Darstellung von den gespeicherten Daten im Bildschirm wurde durch eine Admin-Webseite realisiert. Es wurden viele Layouts für die Anzeige (Bildschirm) entworfen, damit die Informationen auf unterschiedlichen Weisen dargestellt werden können. \\
Das Infotainment System funktioniert wie die meisten Systeme nach dem Server- Client Prinzip. Sowohl der Server, als auch der Client werden näher betrachtet, denn sie sind die Hauptbereiche des ganzen Systems. 
Ein weiterer interessanter Bereich ist der Chatbot. Chatbot wurde deswegen implementiert, weil es die Interaktion des Menschen mit dem System ermöglicht und dadurch wurde angenommen, dass die Umsetzung dieses Komponentes das Interesse des Menschen an dem System erhöhen wird. \\
Dies war eine allgemeine Beschreibung von den bisherigen erreichten Ergebnisse. Entsprechend der jeweiligen Arbeitsaufteilung werden in den folgenden Kapiteln einige von den oben genannten Aspekten näher erläutert. \\
\subsection{Chatbot} 
In diesem Unterkapitel wird eine Einführung in Chatbot gegeben und dessen Umsetzung erklärt.
\subsubsection{Einführung in Chatbot}
Chatbot ist eine sehr wichtige Komponente der künstlichen Intelligenz. Es bietet eine Kommunikationsschnittstelle zwischen Menschen und technischen Systemen an. Chatbot empfängt Anweisungen in Textform von Menschen und überträgt diese so, dass die Systeme diesen Anweisungen ausführt und eine Antwort zurückgibt. Basierend auf was Chatbots anbietet, werden diese als sehr schlaue Komponente angesehen, die immer häufiger implementiert werden.
\subsubsection{Umsetzung von Chatbot}
Chatbot wurde bei dieser Diplomarbeit so implementiert, dass es den Schülern die Möglichkeit gibt, aufgenommene Bilder zum Chatbot zu schicken und diese dann werden automatisch auf dem Bildschirm angezeigt. Das ist auch die wesentliche Funktionalität von Chatbot bei diesem Projekt. \\
Um den Chatbot zu implementieren, haben viele kleine Prozesse stattgefunden, die als weitere oder zusätzliche Funktionen angesehen werden können.\\
Zuerst wurde Telegram Bot API als eine Schnittstelle für die Chatbot-Implementierung ausgewählt. Durch diese API können neue Bots erstellt, bearbeitet und verändert werden. Telegram Bot API funktioniert gleich wie die anderen Kommunikationsapplikationen, wie z.B. Whatsapp. Der wesentliche Unterschied ist, dass bei dieser Applikation nicht nur die Möglichkeit angeboten wird, mit anderen Menschen zu chatten, sondern auch mit Chatbots. Jedes Bot, das erstellt wird, bekommt ein Token, dass eindeutig für das Bot ist, wie die Telefonnummer, die für uns eindeutig ist. \\
Die komplette Funktionalität des Bots wurde in RaspberryPI Server, mithilfe der Programmiersprache Python programmiert. \\
Je nachdem ob die Person, die mit dem Bot chatten will, als ein normaler Benutzer oder ein Administrator in der Datenbank definiert ist, werden ihm verschiedene Funktionen im Zusammenhang mit dem Bot zur Verfügung gestellt. Die Nachrichten, die zu dem Bot geschickt werden, werden nach Inhalt überprüft. Basierend auf Inhalt der Nachrichten, wird der Bot auf verschiedene Weisen reagieren.\\
Die Art der Umsetzung bzw. Realisierung aller dieser Funktionen kann im Unterkapitel 2.1 gelesen werden.   

\subsection{Server}
Das Infotainment System funktioniert wie viele andere technische Systeme auch nach dem Client-Server Prinzip. Das bedeutet, es gibt einen Server und einen Client, die miteinander kommunizieren. Der Client ist in diesem Projekt die Anzeige bzw. das Bildschirm, in dem die von dem Server erhaltene Daten darstellt. \\
Im Server liegen alle benötigten Informationen für die Darstellung. Diese Informationen sind in der Datenbank auf dem Server gespeichert.\\
Der Server beinhaltet auch die grundlegenden Skripts für die Chatbot-Implementierung und für die Programmierung der Admin-Webseite. Im Server wurde auch das SSL Zertifikat für eine sichere Datenübertragung erstellt.\\
Die Kommunikation zwischen dem Client und dem Server wird dann aufgebaut, wenn Daten von dem Server ausgewählt und zum Client geschickt werden. 
Der Server ist der grundlegende Teil des Projekts. Es enthält alle benötigten Ressourcen für die vollständige Umsetzung des Systems.
\subsection{Technologien}
In diesem Unterkapitel werden die verwendeten Technologien und Software-Ressourcen beschrieben.  Es werden die grundlegenden Theorien, die hinter diesen Technologien stehen, im Detail erläutert. Dazu werden auch die Gründe für die Auswahl der Software-Ressourcen erklärt. 
Die folgende Tabelle listet die verwendeten Technologien auf und daneben steht auch eine kurze Beschreibung für jede dieser Technologien.
\begin{table}[h]
	\begin{center}

\label{tab:Tabelle1}
\resizebox{\textwidth}{!}{
	\begin{tabular}{ | l |l |p{5cm} |} 
		\hline
		\textbf{Name} & \textbf{Beschreibung}\\
		\hline
		Apache HTTP Server & Webserver   \\ \hline
	    MySQL& Relationales Datenbanksystem\\ \hline
		PHP	& Serverseitige Programmiersprache\\ \hline
		JavaScript & Programmiersprache zur dynamischen 
		Veränderung von Webseiten \\ \hline 
		Python	& Objektorientierte/ prozedurale Programmiersprache \\ \hline
		HTML &	Auszeichnungssprache zur Erstellung von Inhalten bei Webseiten \\ \hline
		CSS	& Methode, zur Entkopplung von Designanweisungen einer HTML Datei \\ \hline
		Wetter API &	Schnittstelle zur Aufnahme von Wetterdaten aus großen Wettervorhersage-Datenbanken \\ \hline
		JSON	& strukturiertes Dateiformat \\ \hline 
		Telegram API &	Schnittstelle zur Implementierung von Chatbot \\ \hline
		Raspberry PI &	Minirechner, der für Scripting, Linux Programmierung geeignet ist \\ \hline
		SSL &	Methode zur verschlüsselten Datenübertragung zwischen Client Browser und Server \\ \hline
		
\end{tabular} }
%\end{adjustbox} 
\caption{Technologien}
\end{center}
\end{table} 
\subsubsection{Was ist Apache HTTP Server?} 
Der Apache HTTP\footnote{Hypertext Transfer Protocol}\nomenclature{HTTP}{Hypertext Transfer Protocol} Server ist ein weltweit verbreitender Webserver. Dieser Server ist Open Source, das bedeutet, dass dafür keine Lizenz gekauft werden muss, um es zu verwenden. Es ist kompatibel auf allen kohärenteren Betriebssystemen, beispielsweise Linux, Windows, Mac OS und andere. Es bietet viele Versionen an, die zu unterschiedlichen Anwendungsgebiete passen und verbesserte Eigenschaften bereitstellen. Durch diesen Webserver können Webseiten erstellt werden. Die Erstellung der Webseiten erfolgt über serverseitige Scriptsprachen, die von dem Server selbst nicht unterstützt werden. Sie werden als Zusatzfunktionen angehängt. \\
Der Apache HTTP Server bietet viele Funktionalitäten an, die seine Entwicklungsumgebung vergrößern. Die wichtigste davon ist die Möglichkeit der Integration eines SSL \footnote{Secure Socket Layer}\nomenclature{HTTP}{Secure Socket Layer}Zertifikats. Das ermöglicht die Übertragung der Daten in einer verschlüsselten Form. Die detaillierte Funktionsweise eines SSL Zertifikats wird in den Unterkapiteln beschrieben.  \cite{50_apache}
\subsubsection{Funktionsweise von Apache HTTP Server} 
„Obwohl Apache als Webserver bezeichnet wird, handelt es sich nicht um einen physischen Server. Apache ist eine Software, die auf einem Server ausgeführt wird. Seine Aufgabe ist es, eine Verbindung zwischen einem physischen Server mit den gespeicherten Webseiten und den Browsern der Internetuser herzustellen. \\
Wenn ein User eine URL in seinen Webbrowser eingibt, sendet der Browser eine HTTP oder HTTPS \footnote{Hypertext Transfer Protocol Secure}\nomenclature{HTTPS}{Hypertext Transfer Protocol Secure} Anforderung an den Server, auf dem die Webseite gespeichert ist.“ \cite{50_apache} \\

\subsubsection{Was ist MySQL?} 
MySQL ist ein weitverbreitetes relationales Datenbanksystem. Ein relationales Datenbanksystem dient für die Speicherung der Daten in verschiedenen Tabellen auf einer bestimmten Format. Die Datenbanksysteme werden allgemein zur Datenspeicherung und Datenverwaltung verwendet. Ein wichtiges Kriterium für die Datenspeicherung ist die Performanz. Diese Anforderung wird durch MySQL optimal erfüllt. Das ist auch der Grund, warum dieses Datenbanksystem so populär und bekannt ist. Die von MySQL für die Abarbeitung, Verwaltung und Systematisierung von Daten verwendete Sprache ist SQL\footnote{Structured Query Languague}\nomenclature{SQL}{Structured Query Language}. MySQL ist auch eine Open Source Software,
die in meisten Fällen in Verbindung mit serverseitigen Scriptsprachen wie PHP, vorkommt. \cite{50_mysql}
\subsubsection{Funktionsweise von MySQL} 
Das MySQL Datenbanksystem wird sehr häufig implementiert. Es gibt viele Unternehmen und Institutionen, die ihre Daten über eine gewisse Zeit speichern wollen. Das MySQL Datenbanksystem, das die Daten beinhaltet, wird als ein Server angesehen. Jeder, der versucht, Zugriff auf diese Daten zu bekommen, wird als ein Client angesehen. Der Server kann die erforderliche Zugänglichkeit erlauben oder nicht. Das hängt von den Clientrechten ab. Die Daten können von den Clients selektiert, bearbeitet oder gelöscht werden. Diese Ereignisse erfolgen durch SQL-Abfragen. Die SQL-Abfragen werden mithilfe der SQL Datenbanksprache erstellt. \cite{50_mysql}
\subsubsection{Was ist PHP?} 
PHP\footnote{Parallel History Project}\nomenclature{PHP}{Parallel History Project} ist eine serverseitige Programmiersprache. Das bedeutet, dass diese Sprache zur Programmierung von der vom Server auszuführenden Ereignissen verwendet wird. 
PHP ist eine sehr verbreitete Programmiersprache, die am meisten zur Erstellung und Programmierung von Webseiten verwendet wird. Eigentlich ist PHP sehr flexibel, denn es bietet einen großen Schnittstellenansatz an.  Diese Programmiersprache kann auch im Zusammenhang mit Datenbanken genutzt werden. \cite{50_php}
\subsubsection{Funktionsweise von PHP} 
Hier kommt das Client-Server Prinzip wieder vor. Der Webbrowser ist der Client und der Webserver ist der Server. Der mit PHP programmiertes Skript wird zum Webserver geschickt, danach erfolgt die Rückgabe einer HTML-Datei als Antwort zum Webbrowser, der in diesem Fall als Client betrachtet wird. \cite{50_php}
\subsubsection{Was ist JavaScript?} 
JavaScript ist eine Programmiersprache, die am meisten zur Erstellung von dynamischen Funktionalitäten bei Webseiten, verwendet wird. Die JavaScript Programmiersprache hat in der Vergangenheit nur eine beschränkte Anzahl von Funktionen angeboten, aber heutzutage bietet sie eine Vielzahl von Einsatzmöglichkeiten. \cite{50_javascript}
\subsubsection{Mögliche Funktionen von JavaScript} 
„JavaScript wurde entwickelt, um dynamische HTML-Seiten per Webbrowser anzuzeigen. Die Verarbeitung von JavaScript erfolgt meist clientseitig direkt durch den Webbrowser. \\
Mit Hilfe der Skriptsprache JavaScript lassen sich viele dynamische Funktionen realisieren. Hier sind einige Beispiele für die Verwendung von JavaScript:
\begin{itemize}
	\item  dynamische Veränderung von Webseiten – zum Beispiel für die Anzeige eines formatierten und aktualisierten Datums
\end{itemize}
\begin{itemize}
	\item Prüfung von in Formularen eingegebenen Daten auf Plausibilität
\end{itemize}
\begin{itemize}
	\item Anzeige von Laufschriften oder Bannern
\end{itemize}
\begin{itemize}
	\item 	Öffnen und Anzeigen von Dialogfenstern
\end{itemize}
\begin{itemize}
	\item Aktualisieren von Daten einer Webseite ohne neu laden im Browser
\end{itemize}
\begin{itemize}
	\item 	Unterstützung der Eingabe von Daten durch den User
\end{itemize}
\begin{itemize}
	\item Veränderung von Texten oder Grafiken durch den Mauszeiger" \cite{50_javascript}
\end{itemize}
\subsubsection{Was ist Python?} 
Python ist eine objektorientierte Programmiersprache, aber kann auch in prozedurale Programmierung verwendet werden. Sie wurde ausschließlich zum Zweck der einfach einprägsamen Syntax entwickelt. Andererseits haben die Entwickler der Systematisierung des Codes große Bedeutung beigemessen. Wegen dieser angewandten Eigenschaften kann Python in die Gruppe der leichten Programmiersprachen aufgenommen werden. Diese Programmiersprache wird viel verwendet, aber was die Anwendungsumgebung besonders erhöht, ist die Möglichkeit andere Module anzuhängen. Es ist auch eine Open Source Software, der von den Programmierern verwendet, verändert, angepasst bzw. bearbeitet werden kann. Es wird meistens für komplexe Aufgaben verwendet, deswegen wird es als eine Hochsprache betrachtet. \cite{50_python}
\subsubsection{Merkmale von Python} 
\begin{itemize}
	\item Einfach einprägsame Syntax
\end{itemize}
\begin{itemize}
	\item Objektorientierte und prozedurale Programmiersprache
\end{itemize}
\begin{itemize}
	\item Open Source 
\end{itemize}
\begin{itemize}
	\item Hohes Niveau der Programmiersprache
\end{itemize}
\begin{itemize}
	\item Leicht veränderbare Programmiersprache\cite{50_python}
\end{itemize}
\subsubsection{Was ist HTML?} 
HTML\footnote{HyperText Markup Language}\nomenclature{HTML}{HyperText Markup Language} ist keine Programmiersprache, sondern wird für die Erstellung von Inhalten bei Webseiten verwendet. Diese Inhalte können Texte, Bilder oder andere Komponenten sein. HTML wird als eine Auszeichnungssprache angesehen. Sie ist nicht nur für die Erstellung von Inhalten von Webseiten zuständig, sondern auch für ihr Design. Diese Sprache legt mithilfe von bestimmten Tags die Struktur einer Webseite fest. Im Tag werden die Inhalte gespeichert. Es gibt bestimmte Tags für verschiedene Layout-Elemente.\cite{50_html} %\cite{einstein}
\subsubsection{Was ist CSS?} 
CSS\footnote{Cascading Style Sheets}\nomenclature{CSS}{Cascading Style Sheets} wird im Zusammenhang mit HTML verwendet. Diese Methode wird unten genauer betrachtet. \\
„CSS steht für Cascading-Style-Sheets und ist eine Möglichkeit für HTML-Dokumente, den Inhalt einer Seite von den Designanweisungen der einzelnen Elemente, wie zum Beispiel Überschriften, Zitate) zu entkoppeln.“ \cite{50_css}
\subsubsection{Was ist Raspberry PI?} 
Der Raspberry PI ist ein Minirechner, die zur Linux Programmierung, Shell Scripting und Realisierung von technischen Projekten verwendet wird. Es braucht eine Tastatur, eine Maus, einen Netzteil, VGA\footnote{Video Graphics Array}\nomenclature{VGA}{Video Graphics Array} und HDMI\footnote{High-Definition Multimedia Interface}\nomenclature{HDMI}{High-Definition Multimedia Interface}-VGA Konverter, damit es benutzt werden kann. Die Konfiguration von einem Raspberry PI erfolgt durch eine SD-Karte. Diese SD\footnote{Secure Digital Memory Card}\nomenclature{SD}{Secure Digital Memory Card}-Karte beinhaltet das Image, wo das Betriebssystem liegt. Ein Raspberry PI kann in Zusammenhang mit vielen anderen Komponenten verwendet werden.\cite{50_raspi}
\subsubsection{Was ist SSL?} 
SSL steht für Secure Socket Layer und ist für die verschlüsselte Übertragung der Daten vom Browser zum Server verantwortlich. Die Verbindung zwischen dem Server und dem Browser erfolgt durch das HTTPS-Protokoll. Das ist ein Kommunikationsprotokoll, das eine verschlüsselte Datenübertragung ermöglicht. Heutzutage wird TLS\footnote{Transport Layer Security}\nomenclature{SD}{Transport Layer Security} am meisten verwendet, da es das neueste und modernste Standard von SSL ist.\cite{50_ssl}
\subsubsection{SSL-Verschlüsselung}
Um eine verschlüsselte Verbindung zwischen einem Browser und einem Server aufzubauen, werden SSL – Zertifikate integriert. Mittels eines SSL Zertifikats wird die Authentizität einer Webseite überprüft. Das SSL Zertifikat wird von einer Zertifizierungsstelle, erzeugt. Diese Zertifizierungsstelle heißt CA\footnote{Certificate Authority}\nomenclature{CA}{Certificate Authority} und erfordert einige Daten von dem Antragsteller, die für die Erstellung des Zertifikats notwendig sind. Als nächstes, erzeugt der Antragsteller für die Entschlüsselung und Verschlüsselung der übertragenen Daten einen öffentlichen, -und einen privaten Schlüssel. Je grösser die Länge des Schlüssels ist, desto sicherer und besser ist die Verschlüsselung. Meistens werden Schlüssel mit einer Länge von 256 Bit verwendet.\cite{50_ssl}
\subsubsection{Was ist Telegram Bot API?} 
Telegram Bot API\footnote{Application Programming Interface}\nomenclature{API}{Application Programming Interface} ist eine Schnittstelle, die die Implementierung von Chatbot ermöglicht. Es bietet verschiedene Funktionen an, nämlich die Einrichtung, Erstellung und die Verarbeitung von Bots. Die genommenen Funktionen sind in der Dokumentation vom Telegram Bot API klar beschrieben. \cite{50_telegram}  
\subsubsection{Was ist Wetter API?} 
„Wetter APIs sind Schnittstellen, die die Verbindung zu einer großen Wettervorhersage-Datenbank und die Aufnahme benötigter Daten ermöglichen.“ \cite{50_Wetter}
\subsubsection{Was ist JSON?} 
„JSON\footnote{JavaScript Object Notation}\nomenclature{JSON}{Javascript Object Notation} bietet einen einfachen Standard für die strukturierte Kodierung von Daten in Form von menschenlesbarem Text. Dies bietet Vorteile bei einer automatisierten Weiterverarbeitung, macht sie aber auch einer manuellen Inspektion und Überarbeitung besser zugänglich.“ \cite{50_json}
\\
In der untenstehenden Tabelle sind alle Technologien, zusammen mit dem Bereich wo sie gehören, ersichtlich. 
\begin{table}[h]
	\begin{center}
		
		\label{tab:Tabelle2}
	
			\begin{tabular}{ | l |l |} 
				\hline
				\textbf{Bereich} & \textbf{Technologie}\\ \hline 
				Datenbank &	Apache HTTP Server, MySQL, PHP \\ \hline
				Anzeige &	HTML, CSS, JavaScript \\ \hline
				Server &	RaspberryPI, SSL \\ \hline
				Wetterdaten	 &Wetter API, JSON \\ \hline
				Chatbot &	Telegram API, Python \\ \hline
				
				\hline
				 
		
		\end{tabular} 
		\caption{Bereiche und Technologien}
	\end{center}
\end{table} 
\section{Structured Software Design}

Die Abbildung 4.1 stellt den Structed Software Design von dem Server dar. Durch diese Methode wird die komplette Funktionalität des Severs dieses Systems geplant. Alle Module, die miteinander verbunden sind, sind die Komponente des Systems, also Teil des Servers. 
Der Pfeil bei der unteren Abbildung, Init genannt, zeigt das Hochfahren des Servers. Nach der Servereinschaltung wird ein Request zu allen Komponenten geschickt, damit sie auch eingeschaltet werden sollen. Diese Komponente sind der Chatbot, die Datenbank und die APIs. 
Nachdem die Komponenten eingeschalten sind, schicken sie eine Statusmeldung zum Server, wie in der Abbildung 1.1 ersichtlich ist. \\
\\
Nachdem der Chatbot eingeschalten wird und mit der Arbeit angefangen hat, wird er Daten produzieren, die zuerst überprüft werden sollen, ob sie im richtigen Format sind oder nicht. Falls der Chatbot Bilder kriegt, wird ein SQL-Query erstellt und die Daten werden in die Datenbank gespeichert. Falls nicht, wird alles im Log Modul gespeichert. Der Log Modul hat dieselbe Funktionalität für alle Komponenten. Es speichert einfach alle Daten und alle Ergebnisse.
Dasselbe passiert mit der APIs auch. Die WetterAPI und Website API speichern ihre Ergebnisse im Log. Wenn sie Daten zurückliefen, werde sie zuerst validiert und dann auf die Datenbank gespeichert.\\

Am Ende erfolgt eine Anfrage von dem RaspberryPI Server. Er erfordert die gesammelten Daten aller Komponenten. Sie werden zuerst validiert dann von Log genommen und danach zum Server geschickt.
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures server.png}
\caption{Structured Software Design vom Server}
\label{fig:ersteebene}
\section{Konfiguration von Raspberry PI Server}
Folgende Schritte sind für die Konfiguration vom RaspberryPI notwendig: \\
\begin{itemize}
	\item Zuerst wurde ein Image daraufgespielt, die das Betriebssystem von Raspberry PI beinhaltet.
\end{itemize}
\begin{itemize}
	\item Danach wurden die folgenden gebrauchten Paketen installiert: git, vim, apache2, python-pip, telepot, php php-mbstring, mariadb-server php-mysql, phpmyadmin.
\end{itemize}
\begin{itemize}
	\item In der Konfigurationsdatei wurde die IP-Adresse von dem Raspberry PI angelegt.
\end{itemize}
\begin{itemize}
	\item Der nächste Schritt war die Erstellung der Datenbank und der dazugehörigen Tabellen.
\end{itemize}
\begin{itemize}
	\item Dann wurden die Benutzer angelegt und die Rechte vergeben.
\end{itemize}
\begin{itemize}
	\item Als letztens wurde SSH\footnote{Secure Shell}\nomenclature{SSH}{Secure Shell} aktiviert, damit eine sichere Verbindung zu diesem Server von einem externen Gerät ermöglicht werden kann.
\end{itemize}
\section{Datenbank}
\begin{itemize}
	\item Zuerst wurde ein ER\footnote{Entity Relationship}\nomenclature{ER}{Entity Relationship} Diagramm auf Papier gezeichnet. Das Ziel war die richtige Erstellung der benötigten Tabellen. Die Tabellen wurden mit den Spalten und ihren Datentypen erstellt. Es wurden auch die Kardinalitäten dazwischen gezeichnet. Die erstellten Tabellen sind:
	
	\begin{itemize}
		\item Unterricht
	\end{itemize}
    \begin{itemize}
    	\item Fehlende Lehrer
    \end{itemize}
    \begin{itemize}
    	\item Wetterdaten
    \end{itemize}
    \begin{itemize}
	\item Chatbot Users
    \end{itemize}	
	\begin{itemize}
		\item User Rolle im Chatbot
	\end{itemize}
	\begin{itemize}
		\item Chatbot Bilder
	\end{itemize}

\end{itemize}
\begin{itemize}
	\item Basierend auf das ER Diagramm wurden dann die Tabellen mit phpmyadmin erstellt
\end{itemize}
\begin{itemize}
	\item Dann wurden für alle Tabellen mit MySQL Workbench die entsprechenden gespeicherten Prozeduren erstellt 
\end{itemize}	
\begin{figure}[ht]	
	\includegraphics[width=\linewidth]{\ordnerfigures erd_irena.png}
	\caption{ERD}
	\label{fig:erd}
\end{figure}
\section{SSL Verschlüsselung}
Es wurde ein SSL Zertifikat für den Apache HTTP Server eingerichtet.
\begin{itemize}
	\item Zuerst wurde das SSL Modul für Apache aktiviert.
\end{itemize}
\begin{itemize}
	\item Danach wurde das SSL Zertifikat erstellt. 
\end{itemize}
\begin{itemize}
	\item Nach der Erstellung des SSL Zertifikats werden einige Eingaben geschickt, die erfüllt werden sollen. 
\end{itemize}
\begin{itemize}
	\item Danach wurde die Datei /etc/apache2/sites-available/default-ssl.conf geöffnet.
\end{itemize}
\begin{itemize}
	\item Unter der Zeile, wo SSL Engine On steht, wurden die erstellten Zertifikatdateien zugefügt
\end{itemize}
\begin{itemize}
	\item Danach wurde der Virtuellhost mit SSL aktiviert. 
\end{itemize}
\begin{itemize}
	\item Es wurde ein System reboot gemacht und der Apache Server noch einmal gestartet. \cite{50_SSS}
\end{itemize}
\section{Anzeige}
Bei der Anzeige sind die Wetterdaten, Kalenderinformationen, Stundenplan, Supplierplan und die leere Klassen dargestellt. Die Wetterdaten wurden aus dem API Call gelesen, in die Datenbank gespeichert und dann durch ein PHP Skript von der Datenbank abgelesen. Die Formatierung für die Anzeige wurde mit JavaScript gemacht. Die Kalenderinformationen, sind selbst vom Administrator geschriebene Informationen. Diese Informationen sollten so angepasst werden, dass sie in unterschiedlichen Teilbereichen des Layouts hinzugefügt werden können und auch von den anderen lesbar sind. \\
Die Tabellen Supplierplan und Stundenplan wurden aus der Datenbank selektiert und dann mit PHP dargestellt. Die Formatierung wurde ebenfalls mit JavaScript gemacht. Bei Tabellen mit vielen Datensätzen wurde die Tabelle in zwei Seiten aufgeteilt, damit es richtig im Layout der Anzeige angepasst werden kann. Auf die Abbildung 4.3 ist die Darstellung der Wetterdaten auf dem Bildschirm ersichtlich. \\
\section{Offline Betrieb}
Der Offline-Betrieb ist aus mehreren Gründen für das Infotainment-System sehr wichtig. Durch den Offline-Betrieb können die Displays, die Clients sind, bei Stromausfall nicht vollständig ausgeschaltet werden, sondern weiterhin Informationen anzeigen. Da die Displays die Daten kontinuierlich vom Server empfangen, würde ohne Strom die Verbindung zum Server getrennt und die Bildschirme ausgeschaltet. Daher war die Implementierung von Offline-Betrieb äußerst notwendig. Der Offline-Betrieb dient zur Synchronisierung von Daten zwischen Client und Server. Es ermöglicht ein kontinuierliches Backup. Wenn kein Strom vorhanden ist, zeigen die Bildschirme weiterhin die letzten Daten an, die sie vom Server empfangen haben. Die Datenübertragung erfolgt durch Aufrufen eines Skripts mithilfe von crontab Befehl alle 5 Minuten. Crontab dient dazu, ein bestimmtes Ereigniss regelm\"a\ss{}ig auszuf\"uhren. Der Client erhält also automatisch alle Änderungen, die auf dem Server auftreten. Das Skript zum Synchronisieren von Daten wurde manuell mit der PHP-Programmiersprache erstellt.
\begin{itemize}
	\item Es wurde ein PHP-Skript f\"ur die Implementierung von Offline Betrieb erstellt.
	\item Zuerst wurde ein Array mit allen Tabellennamen erstellt. Diese sind die Namen der Tabellen, die im Server liegen.
	\item Es wurde dann eine Verbindung mit dem Server gebaut.
	\item Es wurde ein SQL-Query gebaut, wo alle Daten von den Displays, oder Clients selektiert wurden.
	\item Es wurde eine Verbindung mit jedem Display gemacht.
	\item Nachdem die Verbindung mit den Displays gemacht wurde, wurden die Datens\"tze von den Server-Tabellen, denen Namen im ersten Array sind, selektiert.
	\item Danach wurden die Spalten von diesen Tabellen mithilfe von dem Befehl "Show Columns" aufgelistet.
	\begin{lstlisting}[frame=single]
	$st="SHOW COLUMNS FROM ".$tables[$i].";";
	$pdo = $con->prepare($st);
	$pdo->execute();
	$res = $pdo->fetchAll(PDO::FETCH_ASSOC);
	\end{lstlisting}
	\captionof{lstlisting}{Implementierung von Offline Betrieb}
	\item Es wurden dann die Tabellen, die im Client und im Server sind verglichen. Wenn im Client fehlende Tabellen gibt, wurde dann ein Query gebaut, wo alle Tabellen die im Server sind, aber im Client fehlen, erstellt werden und die Spalten auch.
	 \begin{lstlisting}[frame=single]
	 try{
	 	$stmt="CREATE TABLE IF NOT EXISTS ".$tables[$i]."(";
	 	for($k=0; $k<sizeof($res);$k++) {
	 		if($k!=sizeof($res)-1){
	 			$stmt.=' '.$res[$k]['Field'].' '.$res[$k]['Type'].',';
	 		}else{
	 			$stmt.=' '.$res[$k]['Field'].' '.$res[$k]['Type'].');';
	 		}
	 	}
	 	$pdo = $Connection->prepare($stmt);
	 	$pdo->execute();
	}catch(PDOException $e){
	 	echo "<br> Create failed:". $e->getMessage();
	 \end{lstlisting}
	 \captionof{lstlisting}{Offline Betrieb-Erstellung der fehlenden Tabellen im Client}
	 \item Mithilfe von dem Funktion arraydiff in Python, wurde ein Vergleich zwischen den Tabellen und deren Datens\"atze im Client und im Server gemacht. Falls diese Funktion nichts zur\"uckgibt, bedeutet es, dass der Client schon auf dem neuesten Stand ist. Falls nicht, wird alles was im Server ist, aber im Client nicht, im Client hinzugef\"ugt.
\end{itemize}
\section{Wetterdaten}
\begin{itemize}
	\item Als erster Schritt erfolgte die Registrierung bei openweathermap.org. 
\end{itemize}
\begin{itemize}
	\item 	Danach wurde ein API Key bekannt gegeben, mit dem die API Call gemacht werden kann.
\end{itemize}
\begin{itemize}
	\item Die Antwort von API Call wird im JSON-Format gegeben.
\end{itemize}
\begin{itemize}
	\item Danach erfolgt die Speicherung der bestimmten Parameter, die von dem API CALL kommen, in der Datenbank.
\end{itemize}
\begin{itemize}
	\item Als letztens werden mithilfe von PHP die in der Datenbank gespeicherten Parameter aufgerufen und auf dem Bildschirm angezeigt.
\end{itemize}	
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures weather.jpeg}
\caption{Wetterdaten}
\label{Wetter} 
\captionsetup{type=figure} 
\section{Chatbot}
In diesem Unterkapitel wird der Chatbot und dessen Umsetzung erklärt.
\subsection{Chatbot Einrichtung:}
\begin{itemize}
	\item Zuerst wurde die Applikation Telegram auf dem Handy heruntergeladen
\end{itemize}
\begin{itemize}
	\item Als nächstes wurde nach einem Benutzer mit der Name Botfather gesucht. Der Botfather ist der Verwalter von Bots und ist für die Einrichtung des Chatbots zuständig.
\end{itemize}
\begin{itemize}
	\item Danach wurde zum Botfather eine Anfrage mit dem Befehl /newbot geschickt, um einen neuen Bot zu erstellen. 
\end{itemize}
\begin{itemize}
	\item Der Botfather fragte danach nach, wie das neue Bot genannt wird und was für ein Benutzername es haben wird.  
\end{itemize}
\begin{itemize}
	\item Anschliessend wurde von dem Botfather das Token des neuen Bots bekannt gegeben, mit dem der Bot weiterentwickelt werden kann. 
\end{itemize}
\begin{itemize}
	\item Nach der Durchführung von diesen Schritten, ist der Bot fertig erstellt geworden. Es könnte dann mit dem angegebenen Benutzernamen durchsucht werden und der entsprechende Chat damit geöffnet werden. 
\end{itemize}
\subsection{Einrichtung des Chatbots in RaspberryPI}
Die Entwicklung und die Programmierung von Chatbot wurde am RaspberryPI Server gemacht. Damit der RaspberryPI mit dem Telegram Bot API verbunden werden kann, sollten im Raspberry PI zwei Pakete installiert werden. Diese Pakete sind telepot und python-pip. Telepot ist ein Paket, dass die Verbindung zum Telegram Bot API erstellt und mit einem Python-Framework funktioniert. Python-pip ist die Programmierschnittstelle für Python.\cite{50_telegram}
\subsection{Grundlagen für die Umsetzung von Chatbot}
\begin{itemize}
	\item Als erstens muss ein Python Skript erstellt werden.
\end{itemize}
\begin{itemize}
	\item Danach wurden die benötigten Module für den Python Interpreter importiert.  Der Wichtigste davon ist der, der die Schnittstelle zum Telegram Bot API bildet.
\end{itemize}
\begin{itemize}
	\item Der Token, den wir von dem Botfather bekommen haben, wurde in einer Variable gespeichert. Mit diesem Token ist der Zugriff auf dem erstellten Bot möglich. Mit den dargestellten Funktionen sollte die Verbindung zu dem Infotainment Bot erfolgen und gleichzeitig sollte auch getestet werden, ob diese Verbindung überhaupt funktioniert und ob Informationen von dem Bot zurückkommen. 

\end{itemize}
\begin{itemize}
	\item Dann erfolgt die Verbindung zu der Datenbank. Um die Verbindung mit der Datenbank zu ermöglichen, sollte zuerst die MySQL Bibliothek importiert werden. Das wurde im zweiten Schritt gemacht. 
\end{itemize}
\subsection{Funktionalitäten von Chatbot}
Je nachdem ob die Person, die eine Nachricht zu dem Infotainment Bot schickt, ein Administrator, ein normaler Benutzer oder ein unregistrierter Benutzer ist, werden ihn verschiedene Funktionalitäten angeboten. 
\subsubsection{Unregistrierte Benutzer}
Wenn eine Person zum ersten Mal eine Nachricht zum Infotainment Bot schickt, ist er noch nicht in der Datenbank registriert. Der Bot wird ihn fragen ob er registrieren will oder nicht. Die Möglichkeit zur Registrierung erfolgt durch zwei Buttons, die im Bot integriert werden. Falls der unregistrierte Benutzer Ja druckt, bittet er ihn die Telefonnummer einzugeben. Durch diese Telefonnummer wird dann der Benutzer in der Datenbank gespeichert. Falls nein, wird ihm nur eine Nachricht vom Chatbot zurückgeschickt, ("Registrierung nicht durchgeführt, Interaktion nicht möglich").\\
Die Telefonnummer, die von dem unregistrierten Benutzer eingegeben wird, soll nach Inhalt überprüft werden. Wenn der Benutzer z.B. Text eingibt, wird das nicht genehmigt und nicht gespeichert. Falls es eine Zahl ist, soll es zwischen 10 und 12 Ziffern lang sein und mit einem Prefix anfangen. Ansonsten wird es nicht genehmigt und der unregistrierter Benutzer bekommt wieder die Möglichkeit vom Chatbot die Nummer richtig zu schreiben. \\
Der Infotainment Bot bietet dem unregistrierten Benutzer die M\"oglichkeit, die Sprache zu \"andern. Dieser Benutzer kann zwischen zwei Sprachen w\"ahlen, n\"amlich zwischen Englisch und Deutsch.
Basierend auf der ausgewählten Sprache, erm\"oglicht der Infotainment Bot die Interaktion mit dem Benutzer in dieser Sprache. Daher werden alle Nachrichten in der ausgewählten Sprache an Benutzer geschickt. Momentan stellt der Infotainment Bot nur diese zwei Sprachen zur Verf\"ugung. Das System ist aber skalierbar, was bedeutet, dass es leicht erweitert und adaptiert werden kann. Das hei\ss{}t, dass es k\"onnen dem Benutzer auch andere Sprachen angeboten werden. \\
Die Informationen über den unregistrierten Benutzer wird der Administrator bekommen. Er soll dann die Genehmigung geben, ob diese Person schon eine Interaktion mit dem Chatbot haben darf oder nicht. 
\subsubsection{Normale Benutzer}
Die Daten über die normalen Benutzer sind nach der Registrierung in der Datenbank gespeichert. Diese Benutzer sind vom Administrator genehmigt. Die Nachrichten, die diese normalen Benutzer zum Chatbot schicken werden nach Inhalt überprüft. Falls sie ein Bild schicken, wird dieses Bild auf die Datenbank gespeichert und auf dem Bildschirm angezeigt. \\
Wenn aber der Benutzer eine Nachricht schickt, die kein Bild ist, wird es keine Interaktion mit dem Bot geben, weil dem Bot die anderen Nachrichtformate nicht interessieren. \\
Au\ss{}erdem hat der normale Benutzer, die M\"oglichkeit, die Sprache auszuw\"ahlen. Der Infotainment Bot stellt die Sprachen Englisch und Deutsch zur Verf\"ugung. Je nachdem was man w\"ahtl, wird die Interaktion zwischen Infotainment Bot und den Benutzter in der ausgew\"hlten Sprache gemacht. 

\subsubsection{Administrator}
Dem Administrator werden andere Möglichkeiten zur Verfügung gestellt. Er ist in der Lage die normalen und die unregistrierten Benutzer zu sehen. Die werden von der Datenbank selektiert und durch den Bot dargestellt. Dort kann er die Genehmigung für die unregistrierten Benutzer geben. Er kann auch die normalen Benutzer blockieren, wenn sie einmal ein unpassendes Bild geschickt haben. Der Administrator kann im Falle eines Notfalls eine Nachricht zu allen Benutzern schicken, um sie zu benachrichtigen. \\
Wie alle anderen Benutzer, kann der Administrator die Sprache auswählen, in der die Interaktion mit dem Infotainment Bot stattfinden soll. 
\\
\subsection{Umsetzung der Funktionalitäten}
\begin{itemize}
	\item Zuerst wurde ein Query geschrieben, um zu überprüfen ob die Person, die eine Nachricht zum Bot geschrieben hat, schon in der Datenbank registriert ist oder nicht. \\
\end{itemize} 
\newpage
\begin{lstlisting}[frame=single]
query=("SELECT c_id, role, user_status, checked, telefonnummer 
from  tb_infotainment_system_chatbot_users 
where c_id = %s") %(int(char_id))
count=curs.execute(query)
if count > 0:
	user=curs.fetchone()
\end{lstlisting}
\captionof{lstlisting}{Select Query für die registrierten Benutzer in die Datenbank}
\begin{itemize}
	\item Falls diese Person registriert ist, wird überprüft was f\"ur Rechte er hat. Falls er ein Administrator ist, werden die Nachrichten, die er zum Chatbot sendet analysiert und die entsprechenden Ergebnisse zurückgeschickt. 
\end{itemize}	
\begin{itemize}
	\item Wenn der Administrator /users zum Bot schreibt, bedeutet dass er alle Benutzer sehen will. Es wird ein Query geschrieben, die diese Benutzer aus der Datenbank selektiert. An dem Administrator wird die ID der Benutzer und deren Telefonnummer geschickt. Wenn es keine Benutzer gibt, wird ihm eine Nachricht zur\"uckgeschickt, dass momentan im System keine Benutzer sind.
\end{itemize}
\begin{lstlisting}[frame=single]
if command == '/users':
	userscommand=('SELECT c_id, telefonnummer, (row_number() over (order by c_id)), role, checked,
	user_status from tb_infotainment_chatbot_users')
	count4=curs.execute(userscommand)
	variable1=curs.fetchall()
	if count4>0:
		users2=""
		for users in variable1:
			users2+=(str(users[2])+"|"+" userid: "+str(users[0])+"telefon: "+str(users[1]+"\n")
		bot.sendMessage(chat_id, txt[19][language])
		bot.sendMessage(chat_id, users2)
	else:
		bot.sendMessage(chat_id, txt[21][language])
	
\end{lstlisting}
\captionof{lstlisting}{Darstellung aller  Benutzer}
\begin{itemize}
	\item Wenn der Administrator /SeeUnregisteredUsers zum Chatbot schreibt, bedeutet es dass er die unregistrierten Benutzer sehen will. Ihm werden dann die ID und die Telefonnummer von diesen Benutzern zurückgeschickt. Wenn es keine unregistrierte Benutzer im System sind, wird dem Administrator eine Nachricht geschickt: "Es gibt keine unregistrierte Benutzer". 
\end{itemize}
\begin{lstlisting}[frame=single]
if command == '/see_unregistered_users':
	unregisteredcommand=("Select c_id, telefonnummer,
	(row_number() over (order by c_id) 
	from tb_infotainment_chatbot_users where checked=0")
	count5=curs.execute(unregisteredcommand)
	unconfirmed=curs.fetchall()
	if count5>0:
		users=""
		for user in unconfirmed:
			users+=(str(user[2])+"|"+" userid: "+str(user[0])+
			"telefon: "+str(user[1])+"\n")
		bot.sendMessage(chat_id, txt[22][language])
		bot.sendMessage(chat_id,users)
	else:
		bot.sendMessage(chat_id, txt[23][language])	
\end{lstlisting}
\captionof{lstlisting}{Darstellung der unregistrierten Benutzer}
\begin{itemize}
	\item Wenn der Administrator /DoNotAccept und eine bestimmte Chat ID zum Chatbot schreibt, bedeutet, dass der einen unregistrierten Benutzer nicht genehmigen will. Das bedeutet, dass alle von diesem Benutzer empfangenen Nachrichten werden vom ChatBot nicht berücksichtigt. Wenn der Benutzer, der vom Administrator nicht akzeptiert wurde, versucht, Interaktion mit dem Infotainment Bot zu haben, wird ihm eine Nachricht geschickt, dass die Interaktion nicht m\"oglich ist, weil er einfach nicht genehmigt wurde.
\end{itemize}	
\begin{lstlisting}[frame=single]
if usermng[0]=='/DoNotAccept':
donotacceptquery=("update tb_infotainment_chatbot_users 
	set checked=2 where c_id = %s") %(int(usermng[1]))
	curs.execute(donotacceptquery)
	conn.commit()
	bot.sendMessage(usermng[1],txt[15][language])
	bot.sendMessage(chat_id, txt[20][language])
\end{lstlisting}
\captionof{lstlisting}{Genehmigungen für die neue Registrierungen}
\begin{itemize}
	\item Wenn der Administrator /Accept und eine bestimmte Chat ID zum Chatbot schreibt, bedeutet, dass der einen unregistrierten Benutzer genehmigen will. Das bedeutet, dass dieser Benutzer hat den Status von einem normalen Benutzer gekriegt. Dieser Benutzer bekommt auch eine Nachricht vom Chatbot, dass er vom Administrator akzeptiert wurde und dadurch ist die Interaktion mit dem Infotainment Bot m\"oglich.
\end{itemize}	
\begin{lstlisting}[frame=single]
if usermng[0]=='/Accept':
	acceptquery=("update tb_infotainment_chatbot_users 
	set checked=1 where c_id = %s") %(int(usermng[1]))
	curs.execute(acceptquery)
	conn.commit()
	bot.sendMessage(usermng[1],txt[16][language])
	bot.sendMessage(chat_id, txt[18][language])
\end{lstlisting}
\captionof{lstlisting}{Genehmigungen für die neue Registrierungen}
\begin{itemize}
	\item Der Administrator kann bestimmte Benutzer blockieren, wenn er ‘/Block’ und eine bestimmte Chat ID zum Chatbot schreibt. Wenn die Benutzer, die von dem Administrator blockiert wurden, versuchen, Interaktion mit dem Infotainment Bot zu haben, wird denen eine Nachricht geschickt, dass sie blockiert sind und die Interaktion nicht m\"oglich ist.
\end{itemize}
\begin{lstlisting}[frame=single]
if usermng[0] == '/block':
	updatequery = ("update tb_infotainment_chatbot_users 
	set user_status='1' where c_id = %s") %(int(usermng[1]))
	curs.execute(updatequery)
	conn.commit()
	bot.sendMessage(chat_id, txt[24][language])
\end{lstlisting}
\captionof{lstlisting}{Blockierung der Benutzer}
\begin{itemize}
	\item Im Falle eines Notfalles, kann der Administrator an alle Benutzer eine Nachricht schicken, um sie vorher zu warnen.   
\end{itemize}
\begin{lstlisting}[frame=single]
if command=='/notfall':
querynotfall=("select c_id, user_status from tb_infotainment_chatbot_users where role!='777'")
curs.execute(querynotfall)
variablenotfall=curs.fetchall()
for not in variablenotfall:
	idd=not[0]
	bot.sendMessage(str(idd),txt[26][language])
bot.sendMessage(chat_id, txt[27][language])
\end{lstlisting}
\captionof{lstlisting}{Notfall Nachricht}
\begin{itemize}
	\item Wie vorher erw\"ahnt, kann der Administrator auch die Sprache \"andern. Danach folgt die Interaktion mit dem Chatbot in der ausgew\"ahlten Sprache.   
\end{itemize}
\begin{lstlisting}[frame=single]
if usermng[0]=='/setLanguage':
	global language
	language=1
	if usermng[1]=='EN':
		language=1
		bot.sendMessage(chat_id, txt[12][language])
	elif usermng[1]=='DE':
		language=2
		bot.sendMessage(chat_id, txt[12][language])
	else:
		bot.sendMessage(chat_id, txt[17][language])
\end{lstlisting}
\captionof{lstlisting}{Spracheinstellungen}
\begin{itemize}
	\item Wenn der Administrator eine Nachricht zum Chatbot schickt, dass keine der oberen Befehle ist, dann schickt der Infotainment Bot eine Nachricht zur\"uck, die besagt, dass die von ihm gesendete Nachricht falsch ist, und weist ihn an, zum Menü zu gehen, in dem er alle verfügbaren Optionen sehen kann. Die Men\"u wird dann angezeigt, wenn der Benutzer /info eingibt.
\end{itemize}
\begin{lstlisting}[frame=single]
if command=='/info':
	if language==1:
		bot.sendMessage(chat_id, defaultadminmsgen)
	else:
		bot.sendMessage(chat_id, defaultadminmsgde)
\end{lstlisting}
\captionof{lstlisting}{Hauptmen\"u f\"ur den Administrator}
\begin{itemize}
	\item Falls ein normaler Benutzer die oberen Befehle probiert, wird er vom Chatbot eine Nachricht erhalten, dass er nicht der Administrator ist.
\end{itemize}
\begin{itemize}
	\item Durch diese Funktion wird überprüft, ob die Person, die den Button Ja gedruckt hat, registriert ist oder nicht. Falls nein, bittet Chatbot ihn die Telefonnummer einzuschreiben.
\end{itemize}
\begin{lstlisting}[frame=single]
def on_callback_query(msg):
query_id, from_id, query_data=
telepot.glance(msg,flavor='callback_query')
bot.answerCallbackQuery(query_id, text='getIt')
if query_data=='press1':
	query2=("Select c_id from tb_infotainment_chatbot_users
	 where c_id=%s") %(int(from_id))
	 count1=curs.execute(query2)
	if count1 > 0:
		bot.sendMessage(from_id, txt[11][language])
	else:
		global button
		button="pressed]
		if language==1:
			bot.sendMessage(from_id, text="Please write your phone 
			number below...)
		elif language==2:
			bot.sendMessage(from_id, text="Bitte schreiben Sie 
			Telefonnummer...)
else:
	bot.sendMessage(from_id, text='Registrierung nicht moeglich')
\end{lstlisting}
\captionof{lstlisting}{Überprüfung der Eingabe der Benutzer}
\begin{itemize}
	\item Danach erfolgt die Überprüfung ob die Telefonnummer richtig eingegeben ist oder nicht. Falls ja, wird diese Person in die Datenbank hinzugefügt. Dieser wartet aber auf die Genehmigung des Administrators.
\end{itemize}
\begin{lstlisting}[frame=single] 
query3=("insert into tb_infotainment_chatbot_users" \
"(c_id, user_status, role, telefonnummer, checked)"
"VALUES(%s, %s, %s, %s, %s)")
execute=(chat_id,1,555,reply,0)
curs.execute(query3,execute)
conn.commit()
\end{lstlisting}
\captionof{lstlisting}{Hinzufügen eines neuen Benutzers zur Datenbank} 
\begin{itemize}
	\item Chatbot wird in zwei Sprachen angeboten, n\"amlich in Deutsch und in Englisch. Die Umsetzung wurde so gemacht: \\
		Zuerst wurde eine Tabelle in der Datenbank erstellt. Diese Tabelle hat drei Spalten; id, englisch und deutsch. In den letzten Spalten wurden alle Nachrichten, die Chatbot zu den Benutzern schickt in den jeweiligen Sprachen gespeichert.	Diese Tabelle ist in der Abbildung 1.4 ersichtlich. 
		Es wurde in dem Python-Skript, wo Chatbot programmiert wurde, eine Variable erstellt, die mit dem Wert 1 initialisiert ist. Solange diese Variable das Wert 1 hat, werden zu den Benutzern nur Nachrichten auf Englisch geschickt, weil das Wert 1, bedeutet, dass es nur die Datens\"atze von der ersten Spalte der Tabelle genommen werden. Die erste Spalte der Tabelle ist die Spalte "englisch". Wenn der Benutzer die Sprache auf deutsch umstellt, dann wird die Variable mit dem Wert 2 initialisiert. Es werden dann nur Nachrichten auf deutsch zu den Benutzern geschickt. \\
		\\
		\captionsetup{type=figure}
		\includegraphics[width=\linewidth]{\ordnerfigures multilanguage.jpg}
		\caption{Chatbot Multilanguage} 
		\label{fig:menudmn}
\end{itemize}
\subsection{Konkrete Beispiele mit Bildern} 
In den folgenden Abbildungen werden die Funktionalitäten des Administrators beim Chatbot dargestellt.
\begin{itemize}
	\item Hauptmen\"u f\"ur den Administrator
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildnew.jpeg}
\caption{Hauptmen\"u f\"ur den Administrator} 
\label{fig:menuadmin}
\begin{itemize}
	\item Funktion des Administrators, die Benutzer anzuschauen: Chatbot schickt die Chat ID des Benutzers zurück, die für jeden Benutzer eindeutig ist, und auch die Telefonnummer. Diese Daten sind in der Datenbank gespeichert und werden davon selektiert.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildnew1.jpeg}
\caption{Auflistung der Chatbot-Benutzer} 
\label{fig:chatbotbenutzer}
\begin{itemize}
	\item Funktion des Administrators, die unregistrierten Benutzer anzuschauen: Chatbot schickt die eindeutige Chat ID des Benutzers zurück, die für jeden Benutzer eindeutig ist, und auch die Telefonnummer. Diese Daten sind in der Datenbank gespeichert und werden davon selektiert.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildnew2.jpeg}
\caption{Auflistung der unregistrierten Benutzer}
\label{chatbotben}
\begin{itemize}
	\item Falls es keine unregistrierte Benutzer gibt, schickt der Infotainment Bot eine Nachricht zum Administrator, dass es bereits keine unregistrierte Benutzer im System sind.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildnew3.jpeg}
\caption{Keine Unregistrierte Benutzer}
\label{chatbotbenf}
\begin{itemize}
	\item Der Administrator hat die M\"oglichkeit, die Benutzer zu genehmigen. Er kriegt von Chatbot eine Nachricht zur\"urck, wenn die Genehmigung erfolgreich war. Der Benutzer, der von dem Administrator akzeptiert wurde wird von Chatbot als ein normaler Benutzer angesehen.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildnew4.jpeg}
\caption{Genehmigung des Administrators}
\label{chatbotbenjdf}
\begin{itemize}
	\item Der Administrator hat die M\"oglichkeit, die Benutzer nicht zu akzeptieren. Er kriegt von Chatbot eine Nachricht zur\"urck, wenn die Ablehnung erfolgreich war. Der Benutzer, der von dem Administrator nicht akzeptiert wurde, kann keine Interaktion mit dem Chatbot machen.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildnew5.jpeg}
\caption{Ablehnung des Administrators}
\label{chatbotbenjjdf}
\newpage
\begin{itemize}
	\item Funktion des Administrators, eine Notfallwarnmeldung an alle Benutzern zu schicken. Der Administrator erhält dann eine Bestätigungsnachricht vom Chatbot.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildnew7.jpeg}
\caption{Notfallwarnmeldung}
\label{chatbfotbenjjdf}
\begin{itemize}
	\item Funktion des Administrators, die Benutzer zu blockieren: Der Administrator schreibt einfach das Befehl /block und die Chat-ID des Benutzers. Chatbot schickt eine Nachricht zurück, dass dieser Benutzer geblockt wurde.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildnew8.jpeg}
\caption{Benutzer Blockierung}
\label{fig:chatbotblock} 
\captionsetup{type=figure} 
\begin{itemize}
	\item Funktion des Administrators, die Sprache zu \"andern. In der folgenden Abbildung wurde die Sprache von dem Administrator auf deutsch ge\"andert. Er kriegt eine Best\"atigungsnachricht vom Chatbot, dass die Sprache auf deutsch eingestellt wurde. Das bedeutet, dass die Interaktion wird in der ausgew\"ahlten Sprache folgen und der Administrator wird alle Meldungen nur in dieser Sprache vom Chatbot bekommen.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildnew6.jpeg}
\caption{Spracheinstellungen}
\label{fig:sprachek} 
\captionsetup{type=figure} 
\newpage
In den folgenden Abbildungen werden die Funktionalitäten des unregistrierten Benutzer beim Chatbot dargestellt.
\begin{itemize}
	\item Hauptmen\"u f\"ur den unregistrierten Benutzer
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildunre6.jpeg}
\caption{Hauptmen\"u f\"ur den unregistrierten Benutzer}
\label{fig:chaftboregistr}
\begin{itemize}
	\item Chatbot gibt den Benutzer die Möglichkeit, sich beim Chatbot zu registrieren. Der Benuter hat zwei Buttons zur Wahl. In diesem Fall hat der Benutzer auf "Ja" gedruckt. Der Benutzer soll die Telefonnummer eingeben. Der Chatbot schickt eine Nachricht, wo es erkl\"rt ist, in welcher Format die Telefonnummer geschrieben werden soll.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildunre5.jpeg}
\caption{Registrierung beim Chatbot}
\label{fig:chfdsatboregistr}
\begin{itemize}
	\item Wenn der Benutzer, statt die Telefonnummer Text eingibt, bekommt er eine Fehlermeldung von Chatbot.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildunre4.jpeg}
\caption{Falsche Eingabe des Telefonnummers}
\label{fig:chfdsatboregistrfds}
\begin{itemize}
	\item Wenn die Laenge der Telefonnummer nicht korrekt ist, bekommt der Benutzer eine Fehlermeldung von Chatbot.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildunre3.jpeg}
\caption{Telefonnummer zu kurz}
\label{fig:crboregistrfds}
\begin{itemize}
	\item Wenn die Telefonnummer von dem Benutzer korrekt eingegeben wird, kriegt er eine Meldung von Chatbot und er kann keine Interaktion mit dem Chatbot haben, bis er die Genehmigung von Administrator kriegt.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildunre2.jpeg}
\caption{Korrekte Eingabe des Telefonnummers}
\label{fig:crboreistrfds}
\begin{itemize}
	\item Falls der Benutzer versucht, nachdem er einmal die Telefonnummer eingegeben hat, eine andere Telefonnummer einzugeben, wird der Chatbot ihm eine Nachricht schicken, dass er auf die Genehmigung des Administrators warten soll. Die andere Nachrichte, die später kommen werden nicht berücksichtigt bis der Administrator die Genehmigung gegeben hat.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbild7.jpeg}
\caption{Das Warten der Benutzer auf die Administrator Bestätigung}
\label{fig:chat232bo53}
\begin{itemize}
	\item Falls der Benutzer auf "Nein" druckt, schickt der Chatbot ihm eine Meldung zur\"uck, dass die Interaktion mit dem Chatbot ohne Registrierung nicht m\"oglich ist.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotipy.png}
\caption{Keine Registrierung}
\label{fig:chatffd3}
\begin{itemize}
	\item Funktion von einem unregistrierten Benutzer, die Sprache zu \"andern.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chatbotbildunre1.jpeg}
\caption{Spracheinstellungen f\"ur unregistrierte Benutzer}
\label{fig:chatfd3}
In den folgenden Abbildungen wird die Interaktion eines normalen Benutzer mit dem Chatbot dargestellt.
\begin{itemize}
	\item Hauptmen\"ur f\"ur einen normalen Benutzer
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chat1.jpeg}
\caption{Hauptmen\"ur f\"ur einen normalen Benutzer} 
\label{fig:chgtfd3}
\begin{itemize}
	\item Bilderfunktionalit\"at
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chat.jpeg}
\caption{Bilderfunktionalit\"at} 
\label{fig:chgtf53}
\begin{itemize}
	\item Spracheinstellungen f\"ur einen normalen Benutzer
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures chat2.jpeg}
\caption{Spracheinstellungen f\"ur einen normalen Benutzer} 
\label{fig:chgtf43}
\begin{itemize}
	\item Wenn der Administrator eine Notfallwarnmeldung zu den Benutzern schickt, kriegen die Benutzer die folgenden Nachricht von Chatbot.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures notfalllll.jpeg}
\caption{Notfallwarmeldung vom Administrator} 
\label{fig:chgf43}
In der folgenden Abbildung wird die Interaktion eines blockierten Benutzer mit dem Chatbot dargestellt.
\begin{itemize}
	\item Wenn ein Benutzer von dem Administrator blockiert ist und trotzdem versucht eine Nachricht zum Chatbot zu schicken, wird der Chatbot ihm eine Meldung schicken, dass die von diesem Benutzer erhaltene Nachrichten nicht ber\"ucksichtigt werden, weil er blockiert ist. 
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures nota.jpeg}
\caption{Nachricht von einem blockierten Benutzer}
\label{fig:chatbodfsd53}
In der folgenden Abbildung wird die Interaktion eines nicht akzeptierten Benutzer mit dem Chatbot dargestellt.
\begin{itemize}
	\item Wenn ein Benutzer von dem Administrator nicht akzeptiert ist und trotzdem versucht eine Nachricht zum Chatbot zu schicken, wird der Chatbot ihm eine Meldung schicken, dass die von diesem Benutzer erhaltene Nachrichten nicht ber\"ucksichtigt werden, weil er blockiert ist. 
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures blocked.jpeg}
\caption{Nicht akzeptierter Benutzer}
\label{fig:chatb6dfsd53}
In der folgenden Abbildung wird die Interaktion eines akzeptierten Benutzer mit dem Chatbot dargestellt.
\begin{itemize}
	\item Wenn ein Benutzer von dem Administrator akzeptiert wird, wird der Infotainment Bot ihm eine Nachricht schicken, dass er gerade genehmigt wurde und dass die Interaktion mit dem Chatbot m\"oglich ist. Dieser Benutzer kriegt den Status einer normalen Benutzer.
\end{itemize}
\captionsetup{type=figure}
\includegraphics[width=\linewidth]{\ordnerfigures aky.jpeg}
\caption{Akzeptierter Benutzer }
\label{fig:chatbodged53}
\section{Probleme, Herausforderungen und deren Lösung}
Während der Umsetzung des Projekts gab es einige Probleme und Herausforderungen, die aber am Ende gelöst wurden.
\subsubsection{APIs}

Die APIs haben einige Herausforderungen gebracht. Zuerst sollten die richtigen APIs gefunden werden. Danach sollte nachgeschaut werden, wie sie genau funktionieren. Es sollte genau analysiert, auf welchem Format die API die Daten zurückliefet, damit diese Daten an dem Bildschirm angezeigt werden konnten. 

\subsubsection{Anzeige}

Wie in den oberen Kapiteln erklärt wurde, war die Design Vorbereitung für die Anzeige nicht leicht. Jedes Layout wurde in unterschiedlichen Teilbereichen unterteilt und in jedem Bereich sollten verschiedene Informationen dargestellt werden. Aber die Formatierung war sehr problematisch. Einige Teilbereiche des Layouts waren sehr groß, und die Informationen passten dort wunderbar. Es gab aber andere Sektoren, wo die Information sehr schwer hinpasste. Das wurde mit JavaScript gelöst. Beispielweise sollten die Wetterdaten in allen Sektoren hinpassen, und für jeden Sektor wurde die Formatierung der Wetterdaten anders vorbereitet, ansonsten funktionierte es nicht, und die Informationen wurden irgendwo auf dem Bildschirm angezeigt. Diese Aufgabe hat sehr viel Zeil gebraucht. Das sollte nicht für die Wetterdaten, sondern auch für die Kalenderinformationen gemacht werden. 

Die Tabelle Supplierplan hat eine andere Herausforderung gebracht. Wenn innerhalb eines Tages viele Lehrer in dieser Tabelle eingetragen werden, wird die Tabelle zu groß und somit ist es schwer es anzupassen. Die hierfür gefundene Lösung hier ist es, die Tabelle auf zwei Seiten zu teilen. Das wurde ebenfalls mit JavaScript gemacht. 

\subsubsection{Chatbot}

Chatbot war auch ein neues Konzept. Die Herausforderungen im Bezug auf Chatbot waren nur am Beginn. Es sollte die richtige API gewählt werden und auch die Einrichtung musste passen. 

\subsubsection{Datenbank}

Die Datenbank war problematisch, weil es sollte genau überlegt werden, welche Tabellen notwendig sind und wie sie verwendet werden. \\
Die richtige Erstellung der Prozeduren war auch ein Thema. Es sollte eine Prozedur erstellt werden, die dem Administrator der Webseite mit einer Drop Down Liste alle Lehrer anzeigte, die nicht fehlen, die bereit zum supplieren sind und kein Unterricht haben. Diese Lehrer wurden dann als Supplierer eingetragen. Aber die richtige Kombination der Daten und die Erstellung dieser Prozedur sehr komplex und hat viel Zeit benötigt, bis eine Lösung gefunden wurde. 
\section{Qualitätssicherung, Controlling}
Qualität wurde sicher gestellt, damit die Hauptanforderungen des Auftraggebers vollständig erfüllt werden. Diese Anforderung war die Entwicklung eines Systems, die die wichtigsten Ankündigungen des Tages auf dem Bildschirm in einer digitalisierten Form darstellt. Es sollten auch die Schuldaten angezeigt werden. \\
Zusätzlich zu den Hauptfunktionen wurden auch andere Punkte implementiert, wie Chatbot oder die Darstellung von Wetterdaten auf dem Bildschirm. Chatbot ist eine wichtige Komponente für die Qualitätsicherung, weil es viele Funktionen anbietet. 

\section{Ergebnisse - Irena Bala}
In diesem Kapitel werden die Ergebnisse der Arbeit zusammengefasst.
\subsection{Implementierung}
Die wichtigsten Ergebnisse der Arbeit sind: 
\begin{itemize}
	\item Die Implementierung von einer Hauptkomponente der künstlichen Intelligenz wie Chatbot, die das entwickelte System interessanter macht. 
\end{itemize}
\begin{itemize}
	\item Designvorbereitung für die Anzeige, damit dort die Informationen auf unterschiedliche Weise dargestellt werden können
\end{itemize}
\begin{itemize}
	\item Anlegen einer Datenbank, die als Basis für die Speicherung aller Informationen dient.
\end{itemize}
\begin{itemize}
	\item Verwendung von APIs, die die Möglichkeit anbieten, Zugriff auf verschiedene Daten zu haben und als Schnittstelle dienen für die Implementierung der Komponenten.
\end{itemize}
\begin{itemize}
	\item 
	Einrichtung und Anlegung eines Servers, dass auch der Hauptteil des Systems ist und die Basis für die Zusammensetzung aller Komponenten anbietet
\end{itemize}
\begin{itemize}
	\item 
	Integration des Systems, damit alle Komponenten miteinander verbunden werden können
\end{itemize}
\section{Handbuch für die Bedienung}
In diesem Kapitel ist das Handbuch für die Bedienung von Chatbot beschrieben.
\subsection{Beschreibung der Bedienung als User}
Die Bedienung von Chatbot ist eigentlich sehr leicht. Ein normaler Benutzer ist in der Lage, Bilder zum Chatbot zu schicken die zuerst in die Datenbank gespeichert und automatisch auf dem Bildschirm angezeigt. \\
Zuerst soll am Handy die Applikation Telegram heruntergeladen werden. Danach soll nach dem Benutzername Infotainment gesucht werden. Der Chat mit dem Infotainment Bot wird geöffnet. 
Jeder Benutzer, die eine Interaktion mit Chatbot haben will, soll sich zuerst registrieren. \\
Sobald der Chatbot eine Nachricht von jemandem, der für das erste Mal an ihm etwas schickt, wird der Chatbot ihm fragen ob er sich registrieren will oder nicht. Die Wahl kommt in Form von 2 Buttons, die die Antworten Ja und Nein beinhalten.\\
Für die Registrierung soll Ja geklickt werden und dann muss die Telefonnummer eingegeben werden. \\
Danach soll gewartet, bis der Administrator die Genehmigung für die neue Registrierung gegeben hat. Sobald der Administrator diese Genehmigung gegeben hat, wird dieser Benutzer eine Nachricht bekommen und nur dann kann er Bilder zum Chatbot schicken, die an dem Bildschirm angezeigt werden.
\subsection{Beschreibung der Bedienung als Administrator}
Der Administrator von Chatbot hat andere Funktionalitäten im Vergleich mit einem Benutzer. 
\begin{itemize}
	\item Wenn die Nachricht /users zum Chatbot geschickt wird, wird dem Administrator eine Liste mit allen Chatbot Benutzer zurückgeschickt.
\end{itemize}
\begin{itemize}
	\item Wenn die Nachricht /SeeUnregisteredUsers zum Chatbot geschickt wird, wird dem Administrator eine Liste mit allen unregistrierten Benutzer zurückgeschickt.
\end{itemize}
\begin{itemize}
	\item Der Administrator kann die Benutzer blockieren durch die folgende Eingabe: /block und die Chat ID von dem Benutzer. 
\end{itemize}
\begin{itemize}
	\item Wenn der Administrator eine Registrierung genehmigen will, sollte die folgende Eingabe zum Chatbot geschickt werden: /Accept und die Chat ID von dem Benutzer
\end{itemize}
\begin{itemize}
	\item Wenn der Administrator eine Registrierung nicht genehmigen will, soll die folgende Eingabe schicken: /DoNotAccept und die Chat ID von dem Benutzer
\end{itemize}
\section{Evaluierung und Resümee}
\subsection{Planung vs Realisierung}
Beim Chatbot sind die Anforderungen erfüllt. Die grundlegende Funktionalität, also Bilderaufnahme und deren Darstellung an dem Bildschirm durch Chatbot wurde vollständig gemacht. Zusätzlich sind aber viele neue Funktionen gekommen, wobei die Interaktion des Menschen mit dem Chatbot erhöht wurde. \\
Diese Funktionen sind:
\begin{itemize}
	\item Registrierung beim Chatbot
\end{itemize}
\begin{itemize}
	\item Blockierung bestimmter Benutzer
\end{itemize}
\begin{itemize}
	\item Anlegung der User-Rechte (Administrator, Benutzer)
\end{itemize}
Die Anforderungen bei der Anzeige sind auch erfüllt worden. Dort können verschiedene Informationen angezeigt werden. Für die Anzeige gibt es auch verschiedene Layouts. \\
\\
Die Datenbank wurde anders als geplant, gebaut. Während der Arbeit wurden viele Adaptierungen gemacht. Es sind mehrere Tabellen als geplant erstellt. Eine Tabelle davon ist die Tabelle für die Chatbot Benutzer. Diese war früher nicht geplant, weil es wurde auch die Anlegung von mehreren User-Rechte beim Chatbot nicht geplant. Das bedeutet, dass alle Komponente des Systems miteinander in Zusammenhang sind und wenn eine davon geändert wurde, hatte diese Konsequenzen auf andere Komponenten.  

\subsection{Wertschöpfung und Lessons Learned}
Es wurde das Wissen in den folgenden Bereichen erweitert: \\
\begin{itemize}
	\item HTML
\end{itemize}
\begin{itemize}
	\item CSS
\end{itemize}
\begin{itemize}
	\item PHP
\end{itemize}
\begin{itemize}
	\item JavaScript
\end{itemize}
\begin{itemize}
	\item Einrichtung von Datenbanken
\end{itemize}
\begin{itemize}
	\item Konfiguration von Systemen
\end{itemize} 
\begin{itemize}
	\item Programmierung in Python
\end{itemize}
 \begin{itemize}
 	\item Verwendung von APIs
 \end{itemize}

\label{\docname}

